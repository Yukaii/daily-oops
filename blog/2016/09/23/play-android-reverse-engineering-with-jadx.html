<!DOCTYPE html><html lang="zh-Hant-TW"><head><link rel="alternate" type="application/rss+xml" title="RSS feed for blog posts" href="https://yukai.dev/feed.xml"/><t><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-L4KRS0HB4B"></script><script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){dataLayer.push(arguments);}
                    window.gtag = gtag
                    gtag('js', new Date());

                    gtag('config', 'G-L4KRS0HB4B', {
                      page_path: window.location.pathname,
                    });
                  </script></t><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/><meta name="color-scheme" content="dark light"/><meta name="title" content="用 jadx 來玩玩 Android 逆向工程"/><meta name="author" content="Yukai Huang"/><meta property="article:published_time" content="2016-09-23T00:00:00+00:00"/><meta property="article:published_time" content="2016-09-23T00:00:00+00:00"/><title>用 jadx 來玩玩 Android 逆向工程</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="
# 用 jadx 來玩玩 Android 逆向工程

## 你幹嘛沒事要來逆向工程啦

~~就是因為沒事啊~~。呃不對，其實以前就有聽說過 Android 逆向工具很成熟，不過自從換 iPhone 後就沒怎麼關注 Android 發展了，一直沒機會玩到。

昨天下午剛好就在臉書刷到一款課表 App"/><meta property="og:url" content="https://yukaii.tw/blog/2016/09/23/play-android-reverse-engineering-with-jadx"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2016-09-23T00:00:00+00:00"/><meta property="article:modified_time" content="2016-09-23T00:00:00+00:00"/><meta property="og:title" content="用 jadx 來玩玩 Android 逆向工程"/><meta property="og:description" content="
# 用 jadx 來玩玩 Android 逆向工程

## 你幹嘛沒事要來逆向工程啦

~~就是因為沒事啊~~。呃不對，其實以前就有聽說過 Android 逆向工具很成熟，不過自從換 iPhone 後就沒怎麼關注 Android 發展了，一直沒機會玩到。

昨天下午剛好就在臉書刷到一款課表 App"/><meta property="og:locale" content="zh-Hant-TW"/><meta property="og:site_name" content="Daily Oops!"/><meta name="next-head-count" content="19"/><link rel="preload" href="/_next/static/css/c20bde311b33806b2b03.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c20bde311b33806b2b03.css" data-n-g=""/><link rel="preload" href="/_next/static/css/846e5e8aa362d3e275e5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/846e5e8aa362d3e275e5.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-245f049e565ebf942e09.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.6fff953eb0f638171baa.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.0548f14d3ae76a89d047.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-8e8c420b4c4a76947b1f.js" as="script"/><link rel="preload" href="/_next/static/chunks/dbf3ce33.6f2f67f5c99a958897f3.js" as="script"/><link rel="preload" href="/_next/static/chunks/05062569.734385c6ee52367a76b7.js" as="script"/><link rel="preload" href="/_next/static/chunks/40b9acf6.3bbe0c84743f3f8d6181.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-5a30f02a8095a84179c8.js" as="script"/><link rel="preload" href="/_next/static/chunks/0e226fb0.00cc2de534c16af72a07.js" as="script"/><link rel="preload" href="/_next/static/chunks/9f96d65d.3f3e4ee454904b796427.js" as="script"/><link rel="preload" href="/_next/static/chunks/cfd251cc58582a740a8e871fbe9ca0ae0b814bef.5a386a030c6c6b1c94fc.js" as="script"/><link rel="preload" href="/_next/static/chunks/35c7c14249a4e2e42e1e799eb48e20c6dd8c6b4d.a6a4327d5f475a6f4a89.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bslug%5D-44f6e9ba9dbebd733d28.js" as="script"/></head><body><script src="/noflash.js"></script><div id="__next"><section><div class="d-block text-center color-bg-secondary py-4 px-3"><button class="night-switch-button btn position-absolute top-4 right-4 px-2" type="button"><svg aria-hidden="true" role="img" class="octicon octicon-sun" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" style="display:inline-block;user-select:none;vertical-align:text-bottom"><path fill-rule="evenodd" d="M8 10.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V.75A.75.75 0 018 0zm0 13a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 018 13zM2.343 2.343a.75.75 0 011.061 0l1.06 1.061a.75.75 0 01-1.06 1.06l-1.06-1.06a.75.75 0 010-1.06zm9.193 9.193a.75.75 0 011.06 0l1.061 1.06a.75.75 0 01-1.06 1.061l-1.061-1.06a.75.75 0 010-1.061zM16 8a.75.75 0 01-.75.75h-1.5a.75.75 0 010-1.5h1.5A.75.75 0 0116 8zM3 8a.75.75 0 01-.75.75H.75a.75.75 0 010-1.5h1.5A.75.75 0 013 8zm10.657-5.657a.75.75 0 010 1.061l-1.061 1.06a.75.75 0 11-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm-9.193 9.193a.75.75 0 010 1.06l-1.06 1.061a.75.75 0 11-1.061-1.06l1.06-1.061a.75.75 0 011.061 0z"></path></svg></button><div class="CircleBadge CircleBadge--large mx-auto mb-3" style="overflow:hidden;background-color:#F5CC7F"><img src="/logo-animated.gif" alt="Daily Oops" style="height:auto;max-height:80%" class="user-select-none"/></div><h1>Daily Oops!</h1></div><nav class="UnderlineNav flex-justify-center color-bg-secondary px-3 position-sticky top-0" style="z-index:99"><div class="UnderlineNav-body" role="tablist" style="max-width:100%"><button class="UnderlineNav-item" role="tab" type="button" aria-selected="false"><svg aria-hidden="true" role="img" class="UnderlineNav-octicon" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" style="display:inline-block;user-select:none;vertical-align:text-bottom"><path fill-rule="evenodd" d="M1.326 1.973a1.2 1.2 0 011.49-.832c.387.112.977.307 1.575.602.586.291 1.243.71 1.7 1.296.022.027.042.056.061.084A13.22 13.22 0 018 3c.67 0 1.289.037 1.861.108l.051-.07c.457-.586 1.114-1.004 1.7-1.295a9.654 9.654 0 011.576-.602 1.2 1.2 0 011.49.832c.14.493.356 1.347.479 2.29.079.604.123 1.28.07 1.936.541.977.773 2.11.773 3.301C16 13 14.5 15 8 15s-8-2-8-5.5c0-1.034.238-2.128.795-3.117-.08-.712-.034-1.46.052-2.12.122-.943.34-1.797.479-2.29zM8 13.065c6 0 6.5-2 6-4.27C13.363 5.905 11.25 5 8 5s-5.363.904-6 3.796c-.5 2.27 0 4.27 6 4.27z"></path><path d="M4 8a1 1 0 012 0v1a1 1 0 01-2 0V8zm2.078 2.492c-.083-.264.146-.492.422-.492h3c.276 0 .505.228.422.492C9.67 11.304 8.834 12 8 12c-.834 0-1.669-.696-1.922-1.508zM10 8a1 1 0 112 0v1a1 1 0 11-2 0V8z"></path></svg><span>Home</span></button><button class="UnderlineNav-item" role="tab" type="button" aria-selected="false"><svg aria-hidden="true" role="img" class="UnderlineNav-octicon" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" style="display:inline-block;user-select:none;vertical-align:text-bottom"><path fill-rule="evenodd" d="M0 1.75A.75.75 0 01.75 1h4.253c1.227 0 2.317.59 3 1.501A3.744 3.744 0 0111.006 1h4.245a.75.75 0 01.75.75v10.5a.75.75 0 01-.75.75h-4.507a2.25 2.25 0 00-1.591.659l-.622.621a.75.75 0 01-1.06 0l-.622-.621A2.25 2.25 0 005.258 13H.75a.75.75 0 01-.75-.75V1.75zm8.755 3a2.25 2.25 0 012.25-2.25H14.5v9h-3.757c-.71 0-1.4.201-1.992.572l.004-7.322zm-1.504 7.324l.004-5.073-.002-2.253A2.25 2.25 0 005.003 2.5H1.5v9h3.757a3.75 3.75 0 011.994.574z"></path></svg><span>Blog</span></button><button class="UnderlineNav-item" role="tab" type="button" aria-selected="false"><svg aria-hidden="true" role="img" class="UnderlineNav-octicon" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" style="display:inline-block;user-select:none;vertical-align:text-bottom"><path fill-rule="evenodd" d="M4.72 3.22a.75.75 0 011.06 1.06L2.06 8l3.72 3.72a.75.75 0 11-1.06 1.06L.47 8.53a.75.75 0 010-1.06l4.25-4.25zm6.56 0a.75.75 0 10-1.06 1.06L13.94 8l-3.72 3.72a.75.75 0 101.06 1.06l4.25-4.25a.75.75 0 000-1.06l-4.25-4.25z"></path></svg><span>Projects</span></button><button class="UnderlineNav-item" role="tab" type="button" aria-selected="false"><svg aria-hidden="true" role="img" class="UnderlineNav-octicon" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" style="display:inline-block;user-select:none;vertical-align:text-bottom"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg><span>About</span></button></div></nav><div class="container pt-4 pb-3 px-3"><span class="text-mono color-text-tertiary">September 23, 2016</span></div><div><main id="main" property="schema:mainEntity"><article itemscope="" itemprop="post" typeof="schema:Article schema:BlogPosting" property="schema:articleBody" class="markdown-body container pb-6 px-3"><h1 id="%E7%94%A8-jadx-%E4%BE%86%E7%8E%A9%E7%8E%A9-android-%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B"><a class="anchor" href="#%E7%94%A8-jadx-%E4%BE%86%E7%8E%A9%E7%8E%A9-android-%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a> 用 jadx 來玩玩 Android 逆向工程</h1>
<h2 id="%E4%BD%A0%E5%B9%B9%E5%98%9B%E6%B2%92%E4%BA%8B%E8%A6%81%E4%BE%86%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E5%95%A6"><a class="anchor" href="#%E4%BD%A0%E5%B9%B9%E5%98%9B%E6%B2%92%E4%BA%8B%E8%A6%81%E4%BE%86%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E5%95%A6"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a> 你幹嘛沒事要來逆向工程啦</h2>
<p><s>就是因為沒事啊</s>。呃不對，其實以前就有聽說過 Android 逆向工具很成熟，不過自從換 iPhone 後就沒怎麼關注 Android 發展了，一直沒機會玩到。</p>
<p>昨天下午剛好就在臉書刷到一款課表 App，就簡稱為 「X 社小工具」好了，可以幫你匯入學校的課表，支援多個學校。看了看截圖，感覺是在手機端輸入校務系統登入帳密達成，X 社小工具會幫你抓下來，只是不知道後面 API 怎麽跑（誰知道）。秉持著好奇的心，就讓我來逆向看看吧 XDDD。</p>
<h2 id="%E6%B2%92%E6%89%8B%E6%A9%9F%E4%B9%9F%E8%A6%81%E4%B8%8B%E8%BC%89-apk"><a class="anchor" href="#%E6%B2%92%E6%89%8B%E6%A9%9F%E4%B9%9F%E8%A6%81%E4%B8%8B%E8%BC%89-apk"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a> 沒手機也要下載 APK</h2>
<p>直接把 APK 的 bundle id 貼到 <a href="https://androidappsapk.co/apkdownloader/">androidapk</a> 這個網站就可以下載了，bundle id 長得像 <code>com.facebook.katana</code>。</p>
<h2 id="jadx-%E5%8F%8D%E7%B7%A8%E8%AD%AF%E5%B7%A5%E5%85%B7"><a class="anchor" href="#jadx-%E5%8F%8D%E7%B7%A8%E8%AD%AF%E5%B7%A5%E5%85%B7"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a> jadx 反編譯工具</h2>
<p><img src="https://camo.githubusercontent.com/bd3c0ea851c23c4535e43590a86c940a0786faa6/687474703a2f2f736b796c6f742e6769746875622e696f2f6a6164782f6a6164782d6775692e706e67" alt="jadx"></p>
<p>借一下<a href="https://github.com/skylot/jadx">官方</a>的截圖，<a href="https://github.com/skylot/jadx">jadx</a> 可以直接開啟 apk 檔，把 decompile 過的原始碼顯示出來；除了 gui 界面也有 command line 工具可以讓你直接轉存 source。</p>
<p>載下來解壓縮後有四個檔案：</p>
<pre><code class="language-bash"><button class="btn copy-snippet-button position-absolute top-1 right-1"><i class="far fa-clipboard"></i><i class="fas fa-check"></i></button><table class="fence-wrapper"><tbody><tr><td class="hljs-line-number" data-line-number=1></td><td class="hljs-line" id="LC1">.</td></tr><tr><td class="hljs-line-number" data-line-number=2></td><td class="hljs-line" id="LC2">├── jadx</td></tr><tr><td class="hljs-line-number" data-line-number=3></td><td class="hljs-line" id="LC3">├── jadx-gui</td></tr><tr><td class="hljs-line-number" data-line-number=4></td><td class="hljs-line" id="LC4">├── jadx-gui.bat</td></tr><tr><td class="hljs-line-number" data-line-number=5></td><td class="hljs-line" id="LC5">└── jadx.bat</td></tr></tbody></table></code></pre>
<p><code>cd</code> 進去目錄後執行 <code>./jadx-gui</code>，GUI 界面開啟照著操作，選擇你要解開的 apk 就會顯示 Java code 了，也可以選擇轉存，用你喜歡的 Editor 或 IDE 開起來。</p>
<h2 id="%E8%AE%80%E8%AE%80%E8%AE%80%E8%AE%80%E8%AE%80-code"><a class="anchor" href="#%E8%AE%80%E8%AE%80%E8%AE%80%E8%AE%80%E8%AE%80-code"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a> 讀讀讀讀讀 code</h2>
<p>不像當初 <a href="https://applidium.com/en/news/unbundling_pokemon_go/">Pokemon Go 被逆向</a> 一樣，竟然連個混淆都沒做，X 社小工具解出來的原始碼裡，變數都被換成英文字母 abcde，不過想想我的目的就是拿到 API，就直接搜尋 <code>http://</code>、<code>https://</code> 網址開頭的字串~~</p>
<h3 id="retrofit"><a class="anchor" href="#retrofit"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a> Retrofit</h3>
<p>然後就找到了這段：</p>
<pre><code class="language-java"><button class="btn copy-snippet-button position-absolute top-1 right-1"><i class="far fa-clipboard"></i><i class="fas fa-check"></i></button><table class="fence-wrapper"><tbody><tr><td class="hljs-line-number" data-line-number=1></td><td class="hljs-line" id="LC1"><span class="hljs-function"><span class="hljs-keyword">public</span> Retrofit <span class="hljs-title">a</span><span class="hljs-params">(as asVar)</span> </span>{</td></tr><tr><td class="hljs-line-number" data-line-number=2></td><td class="hljs-line" id="LC2">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Builder().baseUrl(<span class="hljs-string">&quot;https://容我隱藏一下.appspot.com/&quot;</span>).addConverterFactory(GsonConverterFactory.create()).addCallAdapterFactory(RxJavaCallAdapterFactory.create()).callbackExecutor(AsyncTask.THREAD_POOL_EXECUTOR).client(asVar).build();</td></tr><tr><td class="hljs-line-number" data-line-number=3></td><td class="hljs-line" id="LC3">}</td></tr></tbody></table></code></pre>
<p>看網址 Server 還是用 Google App Engine 架的 XD</p>
<p><a href="https://square.github.io/retrofit/">Retrofit</a> 是 Android 用的 HTTP 客戶端，雖然沒用過，不過對於 Retrofit 用 Decorator 標記各個 Endpoint 的寫法印象很深，Retrofit 首頁的範例就這樣寫：</p>
<pre><code class="language-java"><button class="btn copy-snippet-button position-absolute top-1 right-1"><i class="far fa-clipboard"></i><i class="fas fa-check"></i></button><table class="fence-wrapper"><tbody><tr><td class="hljs-line-number" data-line-number=1></td><td class="hljs-line" id="LC1"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">GitHubService</span> </span>{</td></tr><tr><td class="hljs-line-number" data-line-number=2></td><td class="hljs-line" id="LC2">  <span class="hljs-meta">@GET(&quot;users/{user}/repos&quot;)</span></td></tr><tr><td class="hljs-line-number" data-line-number=3></td><td class="hljs-line" id="LC3">  Call&lt;List&lt;Repo&gt;&gt; listRepos(<span class="hljs-meta">@Path(&quot;user&quot;)</span> String user);</td></tr><tr><td class="hljs-line-number" data-line-number=4></td><td class="hljs-line" id="LC4">}</td></tr></tbody></table></code></pre>
<p>接下來只要再找出各式 Decorator 就行啦！</p>
<h3 id="api-endpoints"><a class="anchor" href="#api-endpoints"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a> API Endpoints</h3>
<pre><code class="language-java"><button class="btn copy-snippet-button position-absolute top-1 right-1"><i class="far fa-clipboard"></i><i class="fas fa-check"></i></button><table class="fence-wrapper"><tbody><tr><td class="hljs-line-number" data-line-number=1></td><td class="hljs-line" id="LC1"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">a</span> </span>{</td></tr><tr><td class="hljs-line-number" data-line-number=2></td><td class="hljs-line" id="LC2">    ...</td></tr><tr><td class="hljs-line-number" data-line-number=3></td><td class="hljs-line" id="LC3">    ...</td></tr><tr><td class="hljs-line-number" data-line-number=4></td><td class="hljs-line" id="LC4"></td></tr><tr><td class="hljs-line-number" data-line-number=5></td><td class="hljs-line" id="LC5">    <span class="hljs-meta">@GET(&quot;schools&quot;)</span></td></tr><tr><td class="hljs-line-number" data-line-number=6></td><td class="hljs-line" id="LC6">    h&lt;Map&lt;String, j&gt;&gt; a();</td></tr><tr><td class="hljs-line-number" data-line-number=7></td><td class="hljs-line" id="LC7"></td></tr><tr><td class="hljs-line-number" data-line-number=8></td><td class="hljs-line" id="LC8">    <span class="hljs-meta">@POST(&quot;login&quot;)</span></td></tr><tr><td class="hljs-line-number" data-line-number=9></td><td class="hljs-line" id="LC9">    <span class="hljs-function">h&lt;f&gt; <span class="hljs-title">a</span><span class="hljs-params">(<span class="hljs-meta">@Body</span> e eVar)</span></span>;</td></tr><tr><td class="hljs-line-number" data-line-number=10></td><td class="hljs-line" id="LC10"></td></tr><tr><td class="hljs-line-number" data-line-number=11></td><td class="hljs-line" id="LC11">    <span class="hljs-meta">@GET(&quot;users/{uid}/schedule&quot;)</span></td></tr><tr><td class="hljs-line-number" data-line-number=12></td><td class="hljs-line" id="LC12">    <span class="hljs-function">h&lt;g&gt; <span class="hljs-title">a</span><span class="hljs-params">(<span class="hljs-meta">@Path(&quot;uid&quot;)</span> String str, <span class="hljs-meta">@Header(&quot;Authorization&quot;)</span> String str2)</span></span>;</td></tr><tr><td class="hljs-line-number" data-line-number=13></td><td class="hljs-line" id="LC13"></td></tr><tr><td class="hljs-line-number" data-line-number=14></td><td class="hljs-line" id="LC14">    ...</td></tr><tr><td class="hljs-line-number" data-line-number=15></td><td class="hljs-line" id="LC15">    ...</td></tr><tr><td class="hljs-line-number" data-line-number=16></td><td class="hljs-line" id="LC16">}</td></tr></tbody></table></code></pre>
<p>上面是其中一段程式碼，看起來主要的 API Endpoint 都在這了。</p>
<p>接下來可以用 <code>curl</code> 或 <a href="https://www.getpostman.com/">Postman</a> 來試打 API，從 GET 的 Endpoint 開始，照著 Login 流程做。不過打 schedule API 的時候卻發現重大問題：</p>
<blockquote>
<p>我的課表根本就沒課啊！！</p>
</blockquote>
<p>所以 <code>schedule</code> 只好當做不知道怎麽解了哈哈哈😂</p>
<h3 id="rxjava"><a class="anchor" href="#rxjava"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a> RxJava</h3>
<p>題外話一下，X 社小工具也用了當紅的 Reactive Programming，反編譯後的原始碼就看到一堆短短的 presenter 檔案。</p>
<h3 id="%E5%85%B6%E5%AF%A6%E8%A6%81%E6%8B%BF-api-%E4%B9%9F%E4%B8%8D%E9%9C%80%E8%A6%81%E5%8F%8D%E7%B7%A8%E8%AD%AF"><a class="anchor" href="#%E5%85%B6%E5%AF%A6%E8%A6%81%E6%8B%BF-api-%E4%B9%9F%E4%B8%8D%E9%9C%80%E8%A6%81%E5%8F%8D%E7%B7%A8%E8%AD%AF"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a> 其實要拿 API 也不需要反編譯</h3>
<p>可以用 <a href="https://www.wireshark.org/">Wireshark</a> 之類的封包擷取工具撈一下，不過還是看原始碼直接啦😅</p>
<h2 id="%E6%84%9F%E6%83%B3"><a class="anchor" href="#%E6%84%9F%E6%83%B3"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a> 感想</h2>
<p>看來 ProGuard 一類的混淆工具還是有用的，變數、類別都被換掉，腦內理解搜尋速度至少慢了十倍啊，還沒辦法直接 Go to Definition…</p>
<p>本來想寫個免責聲明，不過敏感資訊都已經藏起來了，應該還好吧 XD 這篇只是個人純粹玩工具、讀讀 code 的心得而已，不要追殺我啊 😂😂😂</p>
</article></main></div><div class="container py-3 px-3"><div shortname="dailyoops" config="[object Object]" id="disqus_thread"></div></div></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"content":"\n# 用 jadx 來玩玩 Android 逆向工程\n\n## 你幹嘛沒事要來逆向工程啦\n\n~~就是因為沒事啊~~。呃不對，其實以前就有聽說過 Android 逆向工具很成熟，不過自從換 iPhone 後就沒怎麼關注 Android 發展了，一直沒機會玩到。\n\n昨天下午剛好就在臉書刷到一款課表 App，就簡稱為 「X 社小工具」好了，可以幫你匯入學校的課表，支援多個學校。看了看截圖，感覺是在手機端輸入校務系統登入帳密達成，X 社小工具會幫你抓下來，只是不知道後面 API 怎麽跑（誰知道）。秉持著好奇的心，就讓我來逆向看看吧 XDDD。\n\n## 沒手機也要下載 APK\n\n直接把 APK 的 bundle id 貼到 [androidapk](https://androidappsapk.co/apkdownloader/) 這個網站就可以下載了，bundle id 長得像 `com.facebook.katana`。\n\n## jadx 反編譯工具\n\n![jadx](https://camo.githubusercontent.com/bd3c0ea851c23c4535e43590a86c940a0786faa6/687474703a2f2f736b796c6f742e6769746875622e696f2f6a6164782f6a6164782d6775692e706e67)\n\n借一下[官方][jadx]的截圖，[jadx][jadx] 可以直接開啟 apk 檔，把 decompile 過的原始碼顯示出來；除了 gui 界面也有 command line 工具可以讓你直接轉存 source。\n\n載下來解壓縮後有四個檔案：\n\n```bash\n.\n├── jadx\n├── jadx-gui\n├── jadx-gui.bat\n└── jadx.bat\n```\n\n`cd` 進去目錄後執行 `./jadx-gui`，GUI 界面開啟照著操作，選擇你要解開的 apk 就會顯示 Java code 了，也可以選擇轉存，用你喜歡的 Editor 或 IDE 開起來。\n\n## 讀讀讀讀讀 code\n\n不像當初 [Pokemon Go 被逆向](https://applidium.com/en/news/unbundling_pokemon_go/) 一樣，竟然連個混淆都沒做，X 社小工具解出來的原始碼裡，變數都被換成英文字母 abcde，不過想想我的目的就是拿到 API，就直接搜尋 `http://`、`https://` 網址開頭的字串~~\n\n### Retrofit\n\n然後就找到了這段：\n\n```java\npublic Retrofit a(as asVar) {\n    return new Builder().baseUrl(\"https://容我隱藏一下.appspot.com/\").addConverterFactory(GsonConverterFactory.create()).addCallAdapterFactory(RxJavaCallAdapterFactory.create()).callbackExecutor(AsyncTask.THREAD_POOL_EXECUTOR).client(asVar).build();\n}\n```\n\n看網址 Server 還是用 Google App Engine 架的 XD\n\n[Retrofit](https://square.github.io/retrofit/) 是 Android 用的 HTTP 客戶端，雖然沒用過，不過對於 Retrofit 用 Decorator 標記各個 Endpoint 的寫法印象很深，Retrofit 首頁的範例就這樣寫：\n\n```java\npublic interface GitHubService {\n  @GET(\"users/{user}/repos\")\n  Call\u003cList\u003cRepo\u003e\u003e listRepos(@Path(\"user\") String user);\n}\n```\n\n接下來只要再找出各式 Decorator 就行啦！\n\n### API Endpoints\n\n```java\npublic interface a {\n    ...\n    ...\n\n    @GET(\"schools\")\n    h\u003cMap\u003cString, j\u003e\u003e a();\n\n    @POST(\"login\")\n    h\u003cf\u003e a(@Body e eVar);\n\n    @GET(\"users/{uid}/schedule\")\n    h\u003cg\u003e a(@Path(\"uid\") String str, @Header(\"Authorization\") String str2);\n\n    ...\n    ...\n}\n```\n\n上面是其中一段程式碼，看起來主要的 API Endpoint 都在這了。\n\n接下來可以用 `curl` 或 [Postman](https://www.getpostman.com/) 來試打 API，從 GET 的 Endpoint 開始，照著 Login 流程做。不過打 schedule API 的時候卻發現重大問題：\n\n\u003e 我的課表根本就沒課啊！！\n\n所以 `schedule` 只好當做不知道怎麽解了哈哈哈😂\n\n### RxJava\n\n題外話一下，X 社小工具也用了當紅的 Reactive Programming，反編譯後的原始碼就看到一堆短短的 presenter 檔案。\n\n### 其實要拿 API 也不需要反編譯\n\n可以用 [Wireshark](https://www.wireshark.org/) 之類的封包擷取工具撈一下，不過還是看原始碼直接啦😅\n\n## 感想\n\n看來 ProGuard 一類的混淆工具還是有用的，變數、類別都被換掉，腦內理解搜尋速度至少慢了十倍啊，還沒辦法直接 Go to Definition...\n\n本來想寫個免責聲明，不過敏感資訊都已經藏起來了，應該還好吧 XD 這篇只是個人純粹玩工具、讀讀 code 的心得而已，不要追殺我啊 😂😂😂\n\n[jadx]: https://github.com/skylot/jadx\n","title":"用 jadx 來玩玩 Android 逆向工程","params":{"year":"2016","month":"09","day":"23","slug":"play-android-reverse-engineering-with-jadx"},"disqus":{"shortname":"dailyoops","domain":"yukaii.tw"}},"__N_SSG":true},"page":"/blog/[year]/[month]/[day]/[slug]","query":{"year":"2016","month":"09","day":"23","slug":"play-android-reverse-engineering-with-jadx"},"buildId":"pw7TZjikXIDiTSMKUIXNR","isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-a119f8eb83dade858dfc.js"></script><script src="/_next/static/chunks/webpack-245f049e565ebf942e09.js" async=""></script><script src="/_next/static/chunks/framework.6fff953eb0f638171baa.js" async=""></script><script src="/_next/static/chunks/commons.0548f14d3ae76a89d047.js" async=""></script><script src="/_next/static/chunks/main-8e8c420b4c4a76947b1f.js" async=""></script><script src="/_next/static/chunks/dbf3ce33.6f2f67f5c99a958897f3.js" async=""></script><script src="/_next/static/chunks/05062569.734385c6ee52367a76b7.js" async=""></script><script src="/_next/static/chunks/40b9acf6.3bbe0c84743f3f8d6181.js" async=""></script><script src="/_next/static/chunks/pages/_app-5a30f02a8095a84179c8.js" async=""></script><script src="/_next/static/chunks/0e226fb0.00cc2de534c16af72a07.js" async=""></script><script src="/_next/static/chunks/9f96d65d.3f3e4ee454904b796427.js" async=""></script><script src="/_next/static/chunks/cfd251cc58582a740a8e871fbe9ca0ae0b814bef.5a386a030c6c6b1c94fc.js" async=""></script><script src="/_next/static/chunks/35c7c14249a4e2e42e1e799eb48e20c6dd8c6b4d.a6a4327d5f475a6f4a89.js" async=""></script><script src="/_next/static/chunks/pages/blog/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bslug%5D-44f6e9ba9dbebd733d28.js" async=""></script><script src="/_next/static/pw7TZjikXIDiTSMKUIXNR/_buildManifest.js" async=""></script><script src="/_next/static/pw7TZjikXIDiTSMKUIXNR/_ssgManifest.js" async=""></script></body></html>