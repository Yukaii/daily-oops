{"pageProps":{"content":"\n# 用 PowerShell 批次轉換 docx 到 pdf\n\n## 近況\n\n內容與標題不符。\n\n我從今年的八月[開始登入](https://alive.yukaii.tw/)替代役 online。替代役自由多了，回想起成功嶺的那兩周，不僅餐餐吃不飽，還因為腸胃炎而再次掉了兩公斤多 Zzz，實在有夠悲劇。\n\n可能因為這麼悲慘的運氣補償機制吧(喂)，我來到了國訓中心開始了一年的役期，也多了些「閒暇時間」可以利用，無論如何都是非常幸運了 QAQ\n\n進入正題吧\n\n## 批次轉換 docx 成 pdf\n\n需求很簡單，也有現成軟體可以達成，不過身為一個開發者，連文書也要做的潮才行。以往一直沒什麼機會在 Windows 下進行自動化(多半是當時還太菜)，有了這個機會當然要好好利用。\n\n雖然沒寫過 PowerShell，不過 Google 第一項結果在 [StackOverFlow](https://stackoverflow.com/a/16537996) 就有了，輕鬆愉快。\n\n### 啟用腳本執行權限\n\n首先設定讓 powershell 可以執行腳本，以系統管理員身分執行 PowerShell 並跑起以下指令：\n\n```powershell\nSet-ExecutionPolicy RemoteSigned\n```\n\n### 寫 PowerShell 腳本\n\n然後把以下腳本存成副檔名為 `.ps1`，比如 `word-to-pdf.ps1`。其中 `$documents_path` 改成目標資料夾路徑。\n\n```powershell\n# From https://stackoverflow.com/a/16537996\n\n$documents_path = 'C:\\Users\\user\\Documents\\blahblahblah'\n$word_app = New-Object -ComObject Word.Application\n\n# This filter will find .doc as well as .docx documents\nGet-ChildItem -Path $documents_path -Filter *.doc? -Recurse | ForEach-Object {\n    $document = $word_app.Documents.Open($_.FullName)\n    $pdf_filename = \"$($_.DirectoryName)\\$($_.BaseName).pdf\"\n    $document.SaveAs([ref] $pdf_filename, [ref] 17)\n    $document.Close()\n}\n\n$word_app.Quit()\n```\n\n注意的是在 `Get-ChildItem` 方法我加上了 `-Recurse` 遞迴參數，讓所有子目錄底下的 `docx` 都能被轉換到。\n\n點擊兩下執行，所有 pdf 就會慢慢產生在 `docx` 檔的旁邊啦，瞬間開始耍廢！(喂)\n\n之後若有更多的 PowerShell 輔助使用腳本，我都會放在 [powershell-study](https://github.com/Yukaii/powershell-study) 這個 repo，歡迎自行取用 :p\n\n(完)\n","title":"用 PowerShell 批次轉換 docx 到 pdf","params":{"year":"2017","month":"08","day":"29","slug":"batch-convert-word-docx-to-pdf"},"disqus":{"shortname":"dailyoops","domain":"yukaii.tw"},"noteId":"X858sFn7QgysUaMOn5w37w"},"__N_SSG":true}